@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewData["Title"] = "Enrollee aproval";
    Layout = "~/Views/Shared/NoLayout.cshtml";
    int successValue = (int)ViewData["Success"];
}
@using Basecode.Data
@using Basecode.Data.ViewModels


<style>
    table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0 10px; /* Adjust vertical spacing */
        table-layout: fixed;
    }

    th, td {
        padding: 10px; /* Adjust padding as needed */
        text-align: center; /* Center align content */
    }
</style>
<script>
    $(document).ready(function () {
        var table = $("#table").DataTable({
            "processing": true, // for show progress bar
            "serverSide": true, // for process server side
            "filter": true, // this is for disable filter (search box)
            "orderMulti": true, // for disable multiple column at once
            "ajax": {
                "url": "/Registrar/ApprovalEnrollment",
                "type": "POST",
                "datatype": "json"
            },
            "columnDefs": [{
                "targets": [0],
                "orderable": true
            },
            {
                "targets": [1],
                "orderable": true
            },
            {
                "targets": [2],
                "orderable": true
            },
            {
                "targets": [3],
                "orderable": true
            },
            {
                "targets": [4],
                "orderable": true
            }
            ],

            "columns": [
                { "data": "firstname", "name": "firstname" },
                { "data": "middlename", "name": "middlename" },
                { "data": "lastname", "name": "lastname" },
                { "data": "examschedule", "name": "examschedule" },
               
                { "data": "gradeenrolled", "name": "gradeenrolled" },
                {
                    data: null, render: function (data, type, row) {
                        return "<a href='#' onclick=admitStudent('" + row.id + "') class='btn btn-success' data-bs-toggle='modal' data-bs-target='#exampleModal'>Accept</a> <a href='#' onclick=setid('" + row.id + "') class='btn btn-danger' data-bs-toggle='modal' data-bs-target='#exampleModal1'>Reject</a>";
                    }
                }
            ]
        });       
    });
    
    function admitStudent(studentId) {
        document.getElementById('studentId').value = studentId;
    }
    function Reject() {
        studentId = document.getElementById("id").value;
        window.location.href = '@Url.Action("UltimatelyRejectNewEnrollee", "Registrar")?id=' + studentId;
    }
    function setid(id)
    {
        document.getElementById("id").value = id;
    }
</script>

<div class="wrapper">
    @await Html.PartialAsync("./_RegistrarSideBar")
    <div class="main p-5">

        <div class="container">

            @if (successValue == 0)
            {
                <div class="alert alert-danger alert-dismissible d-flex align-items-center fade show">
                    <i class="bi-exclamation-octagon-fill"></i>
                    <strong class="mx-2">Error!</strong>@ViewData["ErrorMessage"]
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>

            }
            else if (successValue == 1)
            {
                <div class="alert alert-success alert-dismissible d-flex align-items-center fade show">
                    <i class="bi-check-circle-fill"></i>
                    <strong class="mx-2">Success!</strong>@ViewData["ErrorMessage"]
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            }
            @{
                Constants.ViewDataErrorHandling.Success = -1;
                Constants.ViewDataErrorHandling.ErrorMessage = null;
            }
            <br />
            <div style="width:90%; margin:0 auto;">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item" aria-current="page"><a asp-action="index">Home</a></li>
                        <li class="breadcrumb-item active" aria-current="page"><a>List of Enorllees</a></li>
                    </ol>
                </nav>
                <h1>
                    Approval of new Enrollees
                </h1>
                <div style="width:100%; margin:0 auto;">
                    <table id="table" class="table table-striped table-bordered dt-responsive nowrap" width="100%" cellspacing="0">
                        <thead>
                            <tr>
                                <th>First Name</th>
                                <th>Middle Name</th>
                                <th>Last Name</th>
                                <th>Exam Schedule</th>                               
                                <th>Grade to Enroll</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>


        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Set LRN</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    @using (Html.BeginForm("AdmitNewEnrollee", "Registrar", FormMethod.Post))
                    {
                        <div class="modal-body">
                            <input type="hidden" id="studentId" name="studentId" />
                            <div class="mb-3">
                                <label for="recipient-name" class="col-form-label">LRN:</label>
                                <input type="text" class="form-control" id="lrn" name="lrn" required>
                            </div>

                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-danger">Enroll Student</button>
                        </div>
                    }
                </div>
            </div>
        </div>

        <!--Delete alert Modal -->
        <div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Reject Enrollee?</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <input type="hidden" id="id"/>
                        Are you sure you want to reject this enrollee? This change cannot be undone once you proceed.
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-danger" onclick="Reject()">Proceed</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
